	2) Вывести сведения о фильме с самым большим кассовым сбором за все время.								
SELECT *									
FROM Фильм									
WHERE  id_фильма = ( SELECT  id_фильма FROM Билеты GROUP BY id_фильма ORDER BY SUM(Цена) DESC )									
									
									
									
									
									
									
"1) Вывести данные о фильмах и кол-ве проданных билетов в зависимости от того, как рано их покупают 
(за 1,2, ... дней до показа). Результаты вывести в виде транспорнированной таблицы (оси - название фильма, кол-во дней от продажи до показа)"									
									
									
SELECT  ф.название,  [0], [1],[2],[3]									
FROM (									
	SELECT  id_билета, DATEDIFF(DAY, дата продажи, дата показа) AS date_diff, COUNT (1) AS cnt_билетов								
	FROM Билеты б  LEFT JOIN  Фильм ф ON б.id_фильма=ф.id_фильма								
	GROUP BY id_билета,дата продажи, дата показа )AS sr_table								
									
PIVOT( 	COUNT (1)      								
	FOR date_diff IN [0], [1],[2],[3] ) AS pt_table								



3.	Определите отличие в концепциях построения AdventureWorks2017
и AdventureWorksDW2017 баз. Какая база будет работать быстрее с отчётами? Почему? 

AdventureWorks2017- OLTP система, где данные нормализованы. Будет быстрее работать вставка, но медленнее select
AdventureWorksDW2017 OLAP система,где данные денормализованы. Будет работать быстрее с отчетами т.к. меньше используется join и быстрее выполнится select.